{% extends 'public/public.html.twig' %}

{% block title 'Modifier votre profil' %}

{% block main %}
    <h1 class="mb-5">Modifier votre profil</h1>

    <fieldset class="mb-5">
        <legend class="mb-3">Changer de pseudo</legend>
        {{ form_start(pseudo_form) }}

        {{ form_row(pseudo_form.pseudo) }}
        {{ form_row(pseudo_form.password) }}

        {{ form_rest(pseudo_form) }}
        <button type="submit" class="btn btn-primary">Mettre à jour mon pseudo</button>
        {{ form_end(pseudo_form) }}
    </fieldset>

    <fieldset class="mb-5">
        <legend class="mb-3">Changer de mot de passe</legend>
        {{ form_start(password_form) }}

        {{ form_row(password_form.password) }}
        {{ form_row(password_form.newPassword) }}

        {{ form_rest(password_form) }}
        <button type="submit" class="btn btn-primary">Mettre à jour mon mot de passe</button>
        {{ form_end(password_form) }}
    </fieldset>

    <fieldset class="mb-5">
        <legend class="mb-3">Modifier vos informations personnelles</legend>
        {{ form_start(personal_data_form) }}

        {{ form_row(personal_data_form.firstname) }}
        {{ form_row(personal_data_form.lastname) }}
        {{ form_row(personal_data_form.email) }}
        {{ form_row(personal_data_form.phone) }}
        {{ form_row(personal_data_form.address) }}
        {{ form_row(personal_data_form.postalCode) }}
        {{ form_row(personal_data_form.city) }}

        {{ form_rest(personal_data_form) }}
        <button type="submit" class="btn btn-primary">Mettre à jour mes informations</button>
        {{ form_end(personal_data_form) }}
    </fieldset>

    <fieldset class="mb-5 p-3 rounded-2 border border-2 border-danger">
        <legend class="mb-3 text-danger">Zone dangereuse</legend>
        <p>Vous pouvez supprimer définitivement votre compte sur notre site en cliquant sur le bouton ci-dessous.</p>
        <button type="submit" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#closeAccountModal">Supprimer définitivement mon compte</button>
    </fieldset>

    <div class="modal fade" id="closeAccountModal" tabindex="-1" aria-labelledby="closeAccountModal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="closeAccountModal">Supprimer mon compte</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <p>Êtes-vous sûr(e) de vouloir définitivement supprimer votre compte utilisateur ? Cette action est irréversible.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler et revenir à mon profil</button>
                    <form action="{{ path('user_close_account', { slug: app.user.slug }) }}" method="post" class="mt-2">
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="btn btn-danger">Supprimer mon compte</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
